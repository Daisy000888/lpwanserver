#!/usr/bin/env bash

if [ "$1" = "stop" ]
then
  docker-compose -f docker-compose.yml down
  docker-compose -f development/loraserver/docker-compose.yml down
  docker-compose -f development/databases/docker-compose.demo-db.yml down
  exit 0
fi

# Remove old containers, volumes, and images
./bin/clean.js

# Start databases and prisma
docker-compose -f development/databases/docker-compose.demo-db.yml up -d

# Build UI
./bin/build-ui

# Deploy Prisma
./development/bin/manage-db deploy

# Start Lora Server
docker-compose -f development/loraserver/docker-compose.yml up -d

# Start demo
docker-compose -f docker-compose.yml up -d --build
